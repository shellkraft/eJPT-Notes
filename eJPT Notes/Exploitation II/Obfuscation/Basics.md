
### What is Defence Evasion ?

Defence Evasion consists of techniques that adversaries use to avoid
detection throughout their compromise. Techniques used for defence
evasion include uninstalling/disabling security software or
obfuscating/encrypting data and scripts. Adversaries also leverage and
abuse trusted processes to hide and masquerade their malware. â€” MITRE

### AV detection methods 

AV software will typically utilize signature, heuristic and behaviour based detection.

1. Signature based detection - An AV signature is a unique sequence of bytes that uniquely identifies malware. As a result, you will have to ensure that your obfuscated exploit or payload doesn't match any known signature in the AV database.

We can bypass signature-based detection by modifying the malware's byte sequence,
therefore changing the signature.

2. Heuristic-based detection - Relies on rules or decisions to determine whether a binary is malicious. It also looks for specific patterns within the code or program calls.

3. Behavior based detection - Relies on identifying malware by monitoring it's behavior. (Used for newer strains of malware)

### AV evasion techniques

<u>On-disk Evasion Techniques</u> 

+ Obfuscation - Obfuscation refers to the process of concealing something important, valuable, or critical. Obfuscation reorganizes code in order to make it harder to analyze or reverse engineer.

+ Encoding - Encoding data is a process involving changing data into a new format using a scheme. Encoding is a reversible process; data can be encoded to a new format and decoded to its original format.

+ Packing - Generate executable with new binary structure with a smaller size and therefore provides the payload with a new signature.

+ Crypters - Encrypts code or payloads and decrypts the encrypted code in memory. The decryption key/function is usually stored in a stub. 

<u>In-Memory Evasion Techniques</u>

+ Focuses on manipulation of memory and does not write files to disk.
+ Injects payload into a process by leveraging various Windows APIs.
+ Payload is then executed in memory in a separate thread.

