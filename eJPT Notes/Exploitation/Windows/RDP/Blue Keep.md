### What is Blue Keep ?

- BlueKeep __(CVE-2019-0708)__ is the name given to an RDP vulnerability in Windows that could potentially allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target system is a part of.

- The BlueKeep vulnerability was made public by Microsoft in May 2019.

- The BlueKeep exploit takes advantage of a vulnerability in the Windows RDP protocol that allows attackers to gain access to a chunk of kernel memory consequently allowing them to remotely execute arbitrary code at the system level without authentication.

### Affected Windows versions

- Microsoft released a patch for this vulnerability on May 14th, 2019 and has urged companies to patch this vulnerability as soon as possible. 

- At the time of discovery, about 1 million systems worldwide were found to be vulnerable.

- The BlueKeep vulnerability affects multiple versions of Windows:
	+ XP
	+ Vista
	+ Windows 7
	+ Windows Server 2008 & R2

### Points to ponder

- The BlueKeep vulnerability has various illegitimate PoCâ€™s and exploit code that could be malicious in nature. It is therefore recommended to only utilize verified exploit code and modules for exploitation.

- The BlueKeep exploit has an MSF auxiliary module that can be used to check if a target system if vulnerable to the exploit and also has an exploit module that can be used to exploit the vulnerability on unpatched systems.

- The BlueKeep exploit module can be used to exploit vulnerable Windows systems and consequently provide us with a privileged meterpreter session on the target system.

*Note: Targeting Kernel space memory and applications can cause system crashes.*

### Using `MSF` to scan for `BlueKeep`

```
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
```

### Using `MSF` to exploit `BlueKeep`

```
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
```

- This module will only work for 64 bit versions of Windows.
- We need to manually configure the Windows version we are targeting.
- To check the list of targets type - `show targets`
- Set a target - `set target <target-number>`
- Now we can `run` the module.

*When working within an actual company or enterprise environment, we'd want to be extremely careful with kernel exploits like `BlueKeep` as they can crash the system and cause data loss.*
