
### How to Establish Persistence On Windows Via Services ?

1. Gain initial access and elevate the privileges. 

2. Using `persistence_service` module in `MSF`.
```
use exploit/windows/local/persistence_service
```
- This module works by generating and uploading a payload to the target system, it'll then create a persistence service which executes the payload every 5 seconds.
- This module requires system privileges in order to run. 

3. After running the exploit, we'll obtain another session. We should note down the path to the executable the module generates so that we can delete it after the penetration test is over. 

4. Even if we close all the active sessions with the target system, we should get a connection once we setup the `multi/handler`, as the payload we uploaded on the target system will connect to us every 5 seconds. 